<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>QR Code Scanner</title>
    <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js"></script>
    <!-- You can use Bootstrap or Tailwind for styling -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      .container {
        max-width: 600px;
        margin-top: 50px;
      }
      #video {
        width: 100%;
        border: 2px solid #ccc;
      }
      #result {
        margin-top: 20px;
        font-size: 18px;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h2 class="text-center">QR Code Scanner</h2>
      <div class="text-center">
        <video id="video" autoplay></video>
      </div>
      <div id="result" class="text-center">Scan a QR code!</div>
    </div>

    <script>
      // Get access to the camera
      const videoElement = document.getElementById("video");
      const resultElement = document.getElementById("result");

      // Request camera access
      async function startCamera() {
        try {
          const stream = await navigator.mediaDevices.getUserMedia({
            video: { facingMode: "environment" },
          });
          videoElement.srcObject = stream;
          scanQRCode();
        } catch (error) {
          resultElement.textContent = "Unable to access camera!";
          console.error(error);
        }
      }

      // Scan QR code function
      function scanQRCode() {
        const canvas = document.createElement("canvas");
        const context = canvas.getContext("2d");

        // Update the canvas with the video frame and scan for QR code
        function scan() {
          if (videoElement.readyState === videoElement.HAVE_ENOUGH_DATA) {
            canvas.width = videoElement.videoWidth;
            canvas.height = videoElement.videoHeight;
            context.drawImage(videoElement, 0, 0, canvas.width, canvas.height);

            // Try to decode the QR code
            const imageData = context.getImageData(
              0,
              0,
              canvas.width,
              canvas.height
            );
            const code = jsQR(imageData.data, canvas.width, canvas.height);

            if (code) {
              resultElement.textContent = `QR Code Data: ${code.data}`;
            }
          }
          requestAnimationFrame(scan);
        }

        scan();
      }

      // Start the camera when the page loads
      startCamera();
    </script>
  </body>
</html>
